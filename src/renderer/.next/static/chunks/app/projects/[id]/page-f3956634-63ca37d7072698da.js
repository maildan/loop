(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[588],{1125:(e,t,o)=>{"use strict";o.d(t,{FW:()=>l.A,Hs:()=>n.A,T5:()=>a.A,Vn:()=>i.A,c_:()=>r.A,kr:()=>s.A,sU:()=>d.A,vE:()=>c.A,zW:()=>u.A});var r=o(7911),s=o(9369),a=o(869),c=o(3908),n=o(1855),l=o(4529),i=o(3755),d=o(1778),u=o(2055)},1324:(e,t,o)=>{"use strict";o.d(t,{default:()=>O});var r=o(4568),s=o(7620),a=o(2942),c=o(6034),n=o(7959),l=o(6948),i=o(6580),d=o(9811),u=o(5302),g=o(6293),A=o(1159),h=o(1357),E=o(8856),f=o(5829),p=o(4842),v=o(2933),D=o(662),C=o(3608),R=o(3699);let T={container:"h-screen flex flex-col bg-white dark:bg-gray-900 transition-colors duration-200",main:"flex flex-1 overflow-hidden",editorContainer:"flex-1 flex flex-col h-full bg-white dark:bg-gray-900 transition-colors duration-200"},b=(0,s.memo)(function(e){let{projectId:t}=e;D.V.info("PROJECT_EDITOR","ProjectEditor render started",{projectId:t});let{isLoading:o,error:a,...b}=(0,C.B)(t),x=(0,R.F)(),[O,m]=(0,s.useState)("write"),[w,j]=(0,s.useState)(""),[y,I]=(0,s.useState)(""),[k,P]=(0,s.useState)(!1),[S,_]=(0,s.useState)(!1),[J,V]=(0,s.useState)(!1),[N,G]=(0,s.useState)(!1),F=(0,s.useRef)(null),[B,W]=(0,s.useState)(!1),[M,U]=(0,s.useState)(!1),[L,X]=(0,s.useState)(null),[z,H]=(0,s.useState)(!1),[Q,K]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=async()=>{try{var e,o;let r=await (null==(o=window.electronAPI)||null==(e=o.projects)?void 0:e.getById(t));(null==r?void 0:r.success)&&r.data&&K(r.data)}catch(e){D.V.error("PROJECT_EDITOR","Failed to load full project data",e)}};t&&e()},[t]),(0,s.useEffect)(()=>{if(null==Q?void 0:Q.description)try{let e=Q.description.match(RegExp("\\[Google Docs 연동 정보: (\\{.*\\})\\]$","s"));if(e&&e[1]){let t=JSON.parse(e[1]);t&&t.isGoogleDocsProject&&(U(!0),X(t),D.V.info("PROJECT_EDITOR","Google Docs project detected",{googleDocId:t.googleDocId,googleDocUrl:t.googleDocUrl}))}}catch(e){D.V.debug("PROJECT_EDITOR","Google Docs 메타데이터 파싱 실패",{err:e,projectId:t})}},[null==Q?void 0:Q.description,t]);let Z=(0,s.useCallback)(async()=>{if(M&&(null==L?void 0:L.googleDocId)){H(!0);try{var e,t,o;D.V.info("PROJECT_EDITOR","Syncing with Google Docs",{googleDocId:L.googleDocId});let r=await (null==(t=window.electronAPI)||null==(e=t.oauth)?void 0:e.importGoogleDoc(L.googleDocId));(null==r?void 0:r.success)&&(null==(o=r.data)?void 0:o.content)?(b.setContent(r.data.content),await b.forceSave(),D.V.info("PROJECT_EDITOR","Google Docs sync completed",{contentLength:r.data.content.length})):D.V.warn("PROJECT_EDITOR","Google Docs sync failed",null==r?void 0:r.error)}catch(e){D.V.error("PROJECT_EDITOR","Google Docs sync error",e)}finally{H(!1)}}},[M,null==L?void 0:L.googleDocId,b]);(0,s.useCallback)(async e=>{if(M&&(null==L?void 0:L.googleDocId))try{D.V.info("PROJECT_EDITOR","Updating Google Docs",{googleDocId:L.googleDocId,contentLength:e.length})}catch(e){D.V.error("PROJECT_EDITOR","Google Docs update error",e)}},[M,null==L?void 0:L.googleDocId]);let q=(0,s.useCallback)(()=>{if(null==L?void 0:L.googleDocUrl)try{var e,t;(null==(t=window.electronAPI)||null==(e=t.shell)?void 0:e.openExternal)?window.electronAPI.shell.openExternal(L.googleDocUrl):window.open(L.googleDocUrl,"_blank","noopener"),D.V.info("PROJECT_EDITOR","Opened Google Docs externally",{url:L.googleDocUrl})}catch(e){D.V.error("PROJECT_EDITOR","Failed to open Google Docs",e)}},[null==L?void 0:L.googleDocUrl]);(0,s.useCallback)(e=>{e&&(F.current=e),W(!0),D.V.info("PROJECT_EDITOR","Editor ready (fallback mode)")},[]);let Y=(0,s.useCallback)(()=>window.history.back(),[]),$=(0,s.useCallback)(()=>P(e=>!e),[]),ee=(0,s.useCallback)(()=>{_(e=>!e),D.V.info("PROJECT_EDITOR","AI sidebar ".concat(S?"closed":"opened"))},[S]),et=(0,s.useCallback)(e=>{m("write"),I(e),D.V.info("PROJECT_EDITOR","Navigate to chapter edit",{chapterId:e})},[]),eo=(0,s.useCallback)(e=>{m("synopsis"),j("synopsis"),I(e),D.V.info("PROJECT_EDITOR","Navigate to synopsis edit",{synopsisId:e})},[]),er=(0,s.useCallback)(e=>{m("idea"),j("idea"),I(e),D.V.info("PROJECT_EDITOR","Navigate to idea edit",{ideaId:e})},[]),es=(0,s.useCallback)(()=>{m("structure"),j(""),I("")},[]),ea=(0,s.useCallback)(()=>{G(!0),D.V.info("PROJECT_EDITOR","Share dialog opened")},[]),ec=(0,s.useCallback)(()=>{V(!0),D.V.info("PROJECT_EDITOR","Delete confirmation dialog opened")},[]),en=(0,s.useCallback)(async()=>{try{D.V.info("PROJECT_EDITOR","Deleting project",{projectId:t});let e=await window.electronAPI.projects.delete(t);if(e.success)D.V.info("PROJECT_EDITOR","Project deleted successfully"),V(!1),window.history.back();else throw Error(e.error||"Failed to delete project")}catch(e){D.V.error("PROJECT_EDITOR","Failed to delete project",e)}},[t]),el=(0,s.useCallback)(async()=>{try{let e=b.content||"",t=b.title||"제목없음",o=new Blob([e],{type:"text/markdown;charset=utf-8"}),r=URL.createObjectURL(o),s=document.createElement("a");s.href=r,s.download="".concat(t.replace(/[^a-zA-Z0-9가-힣\s]/g,"_"),".md"),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r),D.V.info("PROJECT_EDITOR","Project exported as markdown",{title:t})}catch(e){D.V.error("PROJECT_EDITOR","Export failed",e)}},[b.content,b.title]),ei=(0,s.useCallback)(e=>{D.V.info("PROJECT_EDITOR","View changed:",e),m(e)},[]);(0,s.useCallback)(e=>D.V.info("PROJECT_EDITOR","Toolbar action:",e),[]);let ed=(0,s.useCallback)(e=>{let{key:t,ctrlKey:o,metaKey:r,shiftKey:s,altKey:a}=e,c=o||r;if(c&&"s"===t){e.preventDefault(),b.forceSave(),D.V.info("PROJECT_EDITOR","Save shortcut triggered");return}if(c&&"f"===t){e.preventDefault(),x.toggleFocusMode(),D.V.info("PROJECT_EDITOR","Focus mode shortcut triggered");return}if(c&&"b"===t){e.preventDefault(),P(e=>!e),D.V.info("PROJECT_EDITOR","Sidebar shortcut triggered");return}if(c&&"d"===t){e.preventDefault(),x.toggleDarkMode(),D.V.info("PROJECT_EDITOR","Dark mode shortcut triggered");return}if("Escape"===t){if(J||N)return;if(x.isFocusMode){e.preventDefault(),x.toggleFocusMode(),D.V.info("PROJECT_EDITOR","Focus mode disabled by ESC");return}let t=new CustomEvent("global:escape",{detail:{source:"ProjectEditor"}});window.dispatchEvent(t),e.preventDefault(),Y(),D.V.info("PROJECT_EDITOR","Back shortcut triggered");return}if("F1"===t){e.preventDefault();let t=new CustomEvent("shortcut:help");window.dispatchEvent(t),D.V.info("PROJECT_EDITOR","Help shortcut triggered");return}},[b.forceSave,x.toggleFocusMode,x.toggleDarkMode,Y]);return((0,s.useEffect)(()=>(window.addEventListener("keydown",ed),()=>window.removeEventListener("keydown",ed)),[ed]),(0,s.useEffect)(()=>{let e=()=>{b.forceSave(),D.V.info("PROJECT_EDITOR","Project save triggered from editor")};return window.addEventListener("project:save",e),()=>window.removeEventListener("project:save",e)},[b.forceSave]),o)?(0,r.jsx)("div",{className:"h-screen flex items-center justify-center bg-white dark:bg-gray-900",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-8 h-8 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"프로젝트를 불러오는 중..."})]})}):a?(0,r.jsxs)("div",{className:"h-screen flex items-center justify-center text-red-500",children:["오류: ",a]}):(0,r.jsxs)(c.z,{children:[(0,r.jsxs)("div",{className:T.container,children:[(0,r.jsx)(d.z,{title:b.title,onTitleChange:b.setTitle,onBack:Y,sidebarCollapsed:k,onToggleSidebar:$,showRightSidebar:S,onToggleAISidebar:ee,isFocusMode:x.isFocusMode,onToggleFocusMode:x.toggleFocusMode,onSave:b.forceSave,onShare:ea,onDownload:el,onDelete:ec,isGoogleDocsProject:M,googleDocMeta:L,isSyncingWithGoogle:z,onSyncWithGoogle:Z,onOpenGoogleDocs:q}),(0,r.jsxs)("div",{className:T.main,children:[!k&&(0,r.jsx)(l.m,{currentView:O,onViewChange:ei,structure:b.structure,characters:b.characters,stats:b.writerStats,collapsed:!1,onAddStructure:()=>{m("structure")},onAddCharacter:()=>{m("characters")},onAddNote:()=>{m("notes")}}),(0,r.jsxs)("div",{className:T.editorContainer,children:["write"===O&&(0,r.jsx)(A.L,{content:b.content,onChange:b.setContent,isFocusMode:x.isFocusMode}),"structure"===O&&(0,r.jsx)(h.l,{structure:b.structure,onStructureChange:b.setStructure,onNavigateToChapterEdit:et,onNavigateToSynopsisEdit:eo,onNavigateToIdeaEdit:er}),"characters"===O&&(0,r.jsx)(E.E,{projectId:t,characters:b.characters,onCharactersChange:b.setCharacters}),"notes"===O&&(0,r.jsx)(f.d,{projectId:t,notes:b.notes||[],onNotesChange:b.setNotes}),"synopsis"===O&&(0,r.jsx)(p.A,{synopsisId:y,onBack:es}),"idea"===O&&(0,r.jsx)(v.Z,{ideaId:y,onBack:es})]}),(0,r.jsx)(i.H,{showRightSidebar:S,toggleRightSidebar:ee,writerStats:b.writerStats,setWordGoal:b.setWordGoal,currentText:b.content,projectId:t})]})]}),(0,r.jsx)(n.S,{}),(0,r.jsx)(u.K,{isOpen:J,projectTitle:b.title,onConfirm:en,onCancel:()=>V(!1)}),(0,r.jsx)(g.G,{isOpen:N,projectTitle:b.title,projectId:t,onClose:()=>G(!1)})]})});class x extends s.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t}),D.V.error("PROJECT_ERROR_BOUNDARY","Client-side exception caught",{error:e.message,stack:e.stack,componentStack:t.componentStack}),console.error("\uD83D\uDEA8 ProjectErrorBoundary caught an error:",e),console.error("Error Info:",t),console.error("Component Stack:",t.componentStack)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:(0,r.jsx)("div",{className:"h-screen flex items-center justify-center bg-white dark:bg-gray-900",children:(0,r.jsxs)("div",{className:"max-w-md text-center p-6",children:[(0,r.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDE35"}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"앗! 오류가 발생했습니다"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"클라이언트에서 예외가 발생했습니다. 페이지를 새로고침하거나 다시 시도해보세요."}),!1,(0,r.jsxs)("div",{className:"space-x-4",children:[(0,r.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"페이지 새로고침"}),(0,r.jsx)("button",{onClick:()=>window.history.back(),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"뒤로 가기"})]})]})}):this.props.children}constructor(e){super(e),this.state={hasError:!1}}}function O(){let e=(0,a.useParams)(),t=(0,a.useSearchParams)(),o=Array.isArray(e.id)?e.id[0]:e.id,s=t.get("open")||t.get("id")||void 0,c="new"===o&&s?s:o||s;return c?(D.V.debug("PROJECT_PAGE","Loading project page",{projectId:c}),(0,r.jsx)(x,{children:(0,r.jsx)(b,{projectId:c})})):(D.V.error("PROJECT_PAGE","Missing project ID in route parameters"),(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"오류"}),(0,r.jsx)("p",{className:"text-slate-600",children:"프로젝트 ID가 없습니다."})]})}))}},1604:(e,t,o)=>{"use strict";o.d(t,{J0:()=>r.useState,Kr:()=>r.useMemo,hb:()=>r.useCallback,li:()=>r.useRef,vJ:()=>r.useEffect});var r=o(7620)},1838:(e,t,o)=>{"use strict";o.d(t,{B1:()=>n.A,B8:()=>i.A,F1:()=>r.A,FE:()=>E.A,FW:()=>A.A,JG:()=>s.A,TB:()=>f.A,X:()=>D.A,a4:()=>g.A,g5:()=>l.A,hN:()=>c.A,iU:()=>a.A,nt:()=>p.A,sD:()=>d.A,vE:()=>u.A,vj:()=>h.A,zW:()=>v.A});var r=o(1067),s=o(5870),a=o(3425),c=o(4736),n=o(1503),l=o(952),i=o(6285),d=o(2279),u=o(3908),g=o(1690),A=o(4529),h=o(5173),E=o(3185),f=o(8262),p=o(6734),v=o(2055),D=o(2463)},1964:(e,t,o)=>{"use strict";o.d(t,{AX:()=>i.A,Bx:()=>A.A,Es:()=>s.A,Gr:()=>c.A,JG:()=>r.A,QR:()=>a.A,TB:()=>f.A,_H:()=>g.A,bd:()=>E.A,e9:()=>d.A,eM:()=>u.A,h1:()=>l.A,ni:()=>n.A,sU:()=>h.A});var r=o(5870),s=o(6090),a=o(6608),c=o(5685),n=o(9878),l=o(584),i=o(3672),d=o(7469),u=o(2935),g=o(2187),A=o(281),h=o(1778),E=o(3642),f=o(8262)},2735:(e,t,o)=>{"use strict";o.d(t,{B8:()=>A.A,Cy:()=>c.A,Hs:()=>h.A,MD:()=>u.A,Pk:()=>E.A,SE:()=>s.A,Vw:()=>n.A,X:()=>p.A,ZU:()=>f.A,_:()=>l.A,_B:()=>d.A,fV:()=>i.A,g5:()=>g.A,hc:()=>r.A,yQ:()=>a.A});var r=o(9966),s=o(7804),a=o(4711),c=o(8976),n=o(853),l=o(7419),i=o(8406),d=o(8110),u=o(8464),g=o(952),A=o(6285),h=o(1855),E=o(1627),f=o(5421),p=o(2463)},3930:(e,t,o)=>{"use strict";o.d(t,{FW:()=>l.A,Gy:()=>r.A,W7:()=>a.A,a4:()=>n.A,iU:()=>c.A,jl:()=>s.A,zW:()=>i.A});var r=o(3643),s=o(1261),a=o(9877),c=o(3425),n=o(1690),l=o(4529),i=o(2055)},4862:(e,t,o)=>{Promise.resolve().then(o.bind(o,1324))},4882:(e,t,o)=>{"use strict";o.d(t,{FW:()=>n.A,JG:()=>r.A,Kq:()=>A.A,TB:()=>d.A,W7:()=>s.A,We:()=>i.A,X:()=>g.A,a4:()=>c.A,eM:()=>l.A,sD:()=>a.A,zW:()=>u.A});var r=o(5870),s=o(9877),a=o(2279),c=o(1690),n=o(4529),l=o(2935),i=o(3052),d=o(8262),u=o(2055),g=o(2463),A=o(8864)},5401:(e,t,o)=>{"use strict";o.d(t,{B1:()=>a.A,FW:()=>c.A,Gy:()=>r.A,KJ:()=>n.A,W7:()=>s.A,X:()=>i.A,zW:()=>l.A});var r=o(3643),s=o(9877),a=o(1503),c=o(4529),n=o(9594),l=o(2055),i=o(2463)},5665:(e,t,o)=>{"use strict";o.d(t,{B0:()=>s.A,Cy:()=>a.A,Gk:()=>g.A,J2:()=>l.A,N_:()=>i.A,Pk:()=>u.A,QR:()=>c.A,a4:()=>d.A,xf:()=>n.A,yN:()=>r.A,z2:()=>A.A});var r=o(4558),s=o(2077),a=o(8976),c=o(6608),n=o(4642),l=o(2907),i=o(5009),d=o(1690),u=o(1627),g=o(260),A=o(3267)},5909:(e,t,o)=>{"use strict";o.d(t,{GJ:()=>l.A,Gy:()=>r.A,W7:()=>s.A,We:()=>i.A,X:()=>d.A,eM:()=>n.A,g5:()=>a.A,h1:()=>c.A});var r=o(3643),s=o(9877),a=o(952),c=o(584),n=o(2935),l=o(5389),i=o(3052),d=o(2463)},6583:(e,t,o)=>{"use strict";o.d(t,{Jl:()=>r.A,QR:()=>s.A,X:()=>l.A,_H:()=>n.A,f5:()=>a.A,gE:()=>c.A});var r=o(4931),s=o(6608),a=o(3385),c=o(5774),n=o(2187),l=o(2463)},6856:(e,t,o)=>{"use strict";o.d(t,{X:()=>s.A,h:()=>r.A});var r=o(9966),s=o(2463)},7099:(e,t,o)=>{"use strict";o.d(t,{J0:()=>r.useState,hb:()=>r.useCallback});var r=o(7620)},7517:(e,t,o)=>{"use strict";o.d(t,{FW:()=>i.A,Pt:()=>c.A,TB:()=>d.A,Vw:()=>l.A,Xh:()=>r.A,c_:()=>a.A,iU:()=>n.A,yQ:()=>s.A});var r=o(9457),s=o(4711),a=o(7911),c=o(1164),n=o(3425),l=o(853),i=o(4529),d=o(8262)},8486:(e,t,o)=>{"use strict";o.d(t,{B:()=>r.A});var r=o(7603)},8627:(e,t,o)=>{"use strict";o.d(t,{X:()=>a.A,m:()=>s.A,o:()=>r.A});var r=o(8130),s=o(4282),a=o(2463)},9897:(e,t,o)=>{"use strict";o.d(t,{hb:()=>r.useCallback,li:()=>r.useRef,vJ:()=>r.useEffect});var r=o(7620)}}]);